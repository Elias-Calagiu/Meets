<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- <link rel="stylesheet" href="/assets/css/style.css" type="text/css" /> -->
    <title>Document</title>
</head>

<body>
    <iframe width="350" height="430" allow="microphone;" src="https://console.dialogflow.com/api-client/demo/embedded/6ea0cdb9-db09-493a-966a-b60e97f4a0f0"></iframe>
    <button class="btn" id="recordBtn"></button>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="SpeechSDK/microsoft.cognitiveservices.speech.sdk.bundle.js"></script>
    <script type="text/javascript">
        var SpeechSDK;
        var recognizer;
        $("document").ready(function () {

            $("#recordBtn").on("click", function () {
                $("#recordBtn").prop("disabled", true)
                // Use the subscription key and configure the SpeechSDK object provided by the file referenced in the index.html file.
                var speechConfig = SpeechSDK.SpeechConfig.fromSubscription("20bad3c2c2a34e2a9ada0c04f778f495", "eastus");
                // Set speech recognition language to US English
                speechConfig.speechRecognitionLanguage = "en-US"
                // Add the user's microphone input
                var audioConfig = SpeechSDK.AudioConfig.fromDefaultMicrophoneInput();
                // Create the SpeechRecognizer object
                recognizer = new SpeechSDK.SpeechRecognizer(speechConfig, audioConfig);

                // Start the voice recognition method. May need to replace with StartContinuousRecognitionAsync later on for more prolonged recognition
                recognizer.recognizeOnceAsync(
                    // If we're successful.
                    function (result) {
                        // Make the button to start speech recognition work again.
                        $("#recordBtn").prop("disabled", false)

                        // Log the result.
                        window.console.log(result)

                        // Close the SpeechRecognizer object, and set the variable to undefined.
                        recognizer.close();
                        recognizer = undefined;
                    },
                    // If there's an error.
                    function (err) {
                        // Also sets the button to work again.
                        $("#recordBtn").prop("disabled", false)
                        // log error to the console.
                        window.console.log(err);

                        // Close the SpeechRecognizer object, and set the variable to undefined.
                        recognizer.close();
                        recognizer = undefined;
                    });
            });
        })
    </script>
</body>

</html>